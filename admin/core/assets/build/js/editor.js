var Editor=function(e){var i=this,a=document,o=[],l=0,n=null;i.area=void 0!==e?e:a.getElementsByTagName("textarea")[0],o[l]={value:i.area.value,selectionStart:0,selectionEnd:0},l++,i.selection=function(){var e=i.area.selectionStart,t=i.area.selectionEnd;return{start:e,end:t,value:i.area.value.substring(e,t),before:i.area.value.substring(0,e),after:i.area.value.substring(t)}},i.select=function(e,t,n){var o=[a.documentElement.scrollTop,a.body.scrollTop,i.area.scrollTop];i.area.focus(),i.area.setSelectionRange(e,t),a.documentElement.scrollTop=o[0],a.body.scrollTop=o[1],i.area.scrollTop=o[2],"function"==typeof n&&n()},i.replace=function(e,t,n){var o=i.selection(),a=o.start,l=(o.end,o.value.replace(e,t));i.area.value=o.before+l+o.after,i.select(a,a+l.length),"function"==typeof n?n():i.updateHistory({value:i.area.value,selectionStart:a,selectionEnd:a+l.length})},i.insert=function(e,t){var n=i.selection(),o=n.start;n.end,i.area.value=n.before+e+n.after,i.select(o+e.length,o+e.length),"function"==typeof t?t():i.updateHistory({value:i.area.value,selectionStart:o+e.length,selectionEnd:o+e.length})},i.wrap=function(e,t,n){var o=i.selection(),a=o.value,l=o.before,r=o.after;i.area.value=l+e+a+t+r,i.select(l.length+e.length,l.length+e.length+a.length),"function"==typeof n?n():i.updateHistory({value:i.area.value,selectionStart:l.length+e.length,selectionEnd:l.length+e.length+a.length})},i.indent=function(e,t){var n=i.selection();0<n.value.length?i.replace(/(^|\n)([^\n])/gm,"$1"+e+"$2",t):(i.area.value=n.before+e+n.value+n.after,i.select(n.start+e.length,n.start+e.length),"function"==typeof t?t():i.updateHistory({value:i.area.value,selectionStart:n.start+e.length,selectionEnd:n.start+e.length}))},i.outdent=function(e,t){var n=i.selection();if(0<n.value.length)i.replace(RegExp("(^|\n)"+e,"gm"),"$1",t);else{var o=n.before.replace(RegExp(e+"$"),"");i.area.value=o+n.value+n.after,i.select(o.length,o.length),"function"==typeof t?t():i.updateHistory({value:i.area.value,selectionStart:o.length,selectionEnd:o.length})}},i.callHistory=function(e){return"number"==typeof e?o[e]:o},i.updateHistory=function(e,t){var n=void 0!==e?e:{value:i.area.value,selectionStart:i.selection().start,selectionEnd:i.selection().end};o["number"==typeof t?t:l]=n,l++},i.undo=function(e){if(1<o.length){1<l?l--:l=1;var t=i.callHistory(l-1);n=0<l?l:l-1,i.area.value=t.value,i.select(t.selectionStart,t.selectionEnd),"function"==typeof e&&e()}},i.redo=function(e){if(null!==n){var t=i.callHistory(n);n<o.length-1?n++:n=o.length-1,l=n<o.length-1?n:n+1,i.area.value=t.value,i.select(t.selectionStart,t.selectionEnd),"function"==typeof e&&e()}}};!function(){String.prototype.capitalize=function(e){return(e?this.toLowerCase():this).replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})};document.querySelector("#editor-area"),document.querySelector(".result"),document.querySelector(".close_window"),document.querySelector(".drag");var e=document.querySelector("#editor-area"),t=document.querySelector("#editor-control").getElementsByTagName("a"),a=new Editor(e),n={progressBar:function(){a.wrap("{ProgressBar  size='","' color='primary'}")},text:function(){a.wrap(" {Text bg='blue' color='white'}","\n{/Text}")},iframe:function(){a.wrap("{Iframe src='link sin https://","'}")},youtube:function(){a.wrap("{Youtube id='id_de_youtube","'}")},vimeo:function(){a.wrap("{Vimeo id='id_de_youtube","'}")},blocks:function(){a.wrap("{Blocks}","\n{/Blocks}")},block:function(){a.wrap("{Block col='4'}","\n{/Block}")},service:function(){a.wrap("{Service icon='heart'cls='mb-5'}","\n{/Service}")},card:function(){a.wrap("{Card col='4' title='heart' img='image_aqui'}","\n{/Card}")},alert:function(){a.wrap("{Alert type='info'}","\n{/Alert}")},btn:function(){a.wrap("{Btn color='link' text='Link' link='","'}")},icon:function(){a.wrap("{Icon type='","mobile'}")},divider:function(){a.insert("{divider}")},more:function(){a.insert("{more}")},bold:function(){a.wrap("**","**")},italic:function(){a.wrap("_","_")},code:function(){a.wrap("`","`")},quote:function(){a.indent("> ")},"ul-list":function(){var e,t=a.selection(),n="";0<t.value.length?a.indent("",function(){a.replace(/^[^\n\r]/gm,function(e){return n+="- ",e.replace(/^/,"- ")}),a.select(t.start,t.end+n.length)}):(e="- List Item",a.indent(e,function(){a.select(t.start+2,t.start+e.length)}))},"ol-list":function(){var e,t=a.selection(),n=0,o="";0<t.value.length?a.indent("",function(){a.replace(/^[^\n\r]/gm,function(e){return o+=++n+". ",e.replace(/^/,n+". ")}),a.select(t.start,t.end+o.length)}):(e="1. List Item",a.indent(e,function(){a.select(t.start+3,t.start+e.length)}))},link:function(){a.selection();var t=null;s("Titulo:","Titulo del link",!1,function(e){t=e,s("URL:","",!0,function(e){e,a.insert("\n["+t+"]("+e+")\n")})})},image:function(){s("Image URL:","",!0,function(e){var t=e.substring(e.lastIndexOf("}")+1,e.lastIndexOf(".")).replace(/[\-\_\+]+/g," ").capitalize();t=t.includes("}")?"Image":decodeURIComponent(t),a.insert("\n!["+t+"]("+e+")\n")})},h1:function(){c("#")},h2:function(){c("##")},h3:function(){c("###")},hr:function(){a.insert("\n\n---\n\n")}},o=document.querySelector("#shortcodes");o.addEventListener("change",function(){var e=this.value;n[e]&&(n[e](),o.selectedIndex=0)});for(var l=0,r=t.length;l<r;++l)u(t[l]),t[l].href="#";var i=0;function c(t){var n;0<a.selection().value.length?a.wrap(t+" ",""):(n=t+" Heading "+t.length+"\n\n",a.insert(n,function(){var e=a.selection().start;a.select(e-n.length+t.length+1,e-2)}))}function u(e){var t=e.hash.replace("#","");n[t]&&e.addEventListener("click",function(e){e.preventDefault(),n[t]()},!1)}function s(e,t,n,o){var a=document.createElement("div");a.className="custom-modal-overlay";var l=document.createElement("div");l.className="custom-modal custom-modal-prompt";var r=['<div class="custom-modal-header">',e,"</div>",'<div class="custom-modal-content"></div>','<div class="custom-modal-action"></div>'].join(" ");l.innerHTML=r;var i=function(e){a.parentNode.removeChild(a),l.parentNode.removeChild(l),"function"==typeof o&&o(e)},c=document.createElement("input");c.type="text",c.value=t,c.addEventListener("keyup",function(e){n?13==e.keyCode&&""!==this.value&&this.value!==t&&i(this.value):13==e.keyCode&&i(this.value==t?"":this.value)},!1);var u=document.createElement("button");u.innerHTML="Ok",u.addEventListener("click",function(){n?""!==c.value&&c.value!==t&&i(c.value):i(c.value==t?"":c.value)},!1);var s=document.createElement("button");s.innerHTML="Cancel",s.addEventListener("click",function(){a.parentNode.removeChild(a),l.parentNode.removeChild(l)},!1),document.body.appendChild(a),document.body.appendChild(l),l.children[1].appendChild(c),l.children[2].appendChild(u),l.children[2].appendChild(s),c.focus()}a.area.addEventListener("keydown",function(e){i<5?i++:(a.updateHistory(),i=0),e.shiftKey&&9==e.keyCode?(e.preventDefault(),a.outdent("  ")):9==e.keyCode&&(e.preventDefault(),a.indent("    "))});var d=document.querySelector("#texto"),f=document.querySelector("#btnExpand");d&&f.addEventListener("click",function(){d.classList.toggle("full-width"),d.classList.contains("full-width")?document.body.style.overflow="hidden":document.body.style.overflow="auto"});var v=document.querySelectorAll(".image-link"),p=document.querySelector(".image-preview");v&&Array.from(v).forEach(function(t){t.addEventListener("mouseover",function(e){p.textContent="",p.textContent=t.textContent.trim()})})}();